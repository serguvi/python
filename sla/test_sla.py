import unittest
from slamodule import *


class TestSlo(unittest.TestCase):

    def test_constructor(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '1'], [1665264066.078, '1'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object = Slo(test_json, "0")
        assert slo_object is not None

    def test_constructor1(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': []}}
        slo_object = None
        try:
            slo_object = Slo(test_json, "0")
        except Exception as e:
            pass
        assert slo_object is None

    def test_downtime(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '1'], [1665264066.078, '1'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object = Slo(test_json, "0")
        downtime = slo_object.get_downtime()
        assert downtime == 0

    def test_downtime1(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '0'], [1665264066.078, '0'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '0'], [1665268858.632, '0'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object = Slo(test_json, "0")
        downtime = slo_object.get_downtime()
        assert int(downtime) == 39

    def test_slo(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '1'], [1665264066.078, '1'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object = Slo(test_json, "0")
        slo = slo_object.get_slo()
        assert slo == 100

    def test_slo1(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '0'], [1665264066.078, '0'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object = Slo(test_json, "0")
        slo = slo_object.get_slo()
        assert slo == 98.695


class TestSla(unittest.TestCase):

    def test_sla(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '1'], [1665264066.078, '1'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object1 = Slo(test_json, "0")
        slo_object2 = Slo(test_json, "0")
        sla_object = Sla(slo_object1, slo_object2)
        sla = sla_object.get_sla()
        assert sla == 100

    def test_sla1(self):
        test_json = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '0'], [1665264066.078, '0'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object1 = Slo(test_json, "0")
        slo_object2 = Slo(test_json, "0")
        sla_object = Sla(slo_object1, slo_object2)
        sla = sla_object.get_sla()
        assert sla == 98.695

    def test_sla2(self):
        test_json1 = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '0'], [1665264066.078, '0'], [1665264657.931, '1'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        test_json2 = {'status': 'success', 'data': {'resultType': 'matrix', 'result': [{'metric': {
            '__name__': 'URL_Availability_omi', 'type': 'Web Script', 'name': 'URL_Availability_omi',
            'ims_system_id': 'ЦСМИС', 'metric_name': 'Omi_test_GW1/Login_AuthorizationForm/Status',
            'path': 'Работоспособность консоли Omi/0600itomgw1/URL_Availability_omi',
            'target': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip',
            'targetip': 'c:\\sitescope\\templates.webscripts\\omi_test_gw1.zip'},
            'values': [[1665262944.516, '1'], [1665263530.322, '1'], [1665264066.078, '1'], [1665264657.931, '0'],
                       [1665265257.94, '1'], [1665265857.995, '1'], [1665266458.16, '1'], [1665267059.325, '1'],
                       [1665267658.499, '1'], [1665268258.417, '1'], [1665268858.632, '1'], [1665269505.298, '1'],
                       [1665270070.104, '1'], [1665270678.551, '1'], [1665271395.215, '1'], [1665271926.49, '1'],
                       [1665272546.046, '1'], [1665273112.569, '1'], [1665273747.688, '1'], [1665274258.15, '1'],
                       [1665274858.458, '1'], [1665275458.373, '1'], [1665276058.383, '1'], [1665276657.794, '1'],
                       [1665277258.521, '1'], [1665277858.296, '1'], [1665278458.122, '1'], [1665279106.054, '1'],
                       [1665279739.329, '1'], [1665280281.105, '1'], [1665280871.365, '1'], [1665281506.796, '1'],
                       [1665282137.005, '1'], [1665282708.983, '1'], [1665283340.493, '1'], [1665284031.25, '1'],
                       [1665284460.336, '1'], [1665285058.173, '1'], [1665285658.227, '1'], [1665286258.174, '1'],
                       [1665286858.011, '1'], [1665287458.778, '1'], [1665288058.819, '1'], [1665288658.968, '1'],
                       [1665289258.141, '1'], [1665289904.135, '1'], [1665290471.3, '1'], [1665291093.728, '1'],
                       [1665291743.675, '1'], [1665292315.997, '1'], [1665292968.116, '1'], [1665293519.515, '1'],
                       [1665294131.619, '1'], [1665294658.447, '1'], [1665295258.41, '1'], [1665295858.185, '1'],
                       [1665296458.007, '1'], [1665297058.438, '1'], [1665297658.353, '1'], [1665298258.163, '1'],
                       [1665298858.457, '1'], [1665299506.604, '1'], [1665300058.415, '1'], [1665300706.035, '1'],
                       [1665301318.481, '1'], [1665301891.947, '1'], [1665302541.128, '1'], [1665303129.309, '1'],
                       [1665303765.421, '1'], [1665304407.681, '1'], [1665304857.892, '1'], [1665305457.945, '1'],
                       [1665306057.798, '1'], [1665306657.823, '1'], [1665307258.1, '1'], [1665307858.624, '1'],
                       [1665308458.43, '1'], [1665309058.068, '1'], [1665309669.327, '1'], [1665310259.508, '1'],
                       [1665310885.816, '1'], [1665311494.294, '1'], [1665312088.6, '1'], [1665312778.342, '1'],
                       [1665313301.241, '1'], [1665313950.703, '1'], [1665314564.692, '1'], [1665315057.934, '1'],
                       [1665315657.834, '1'], [1665316258.704, '1'], [1665316857.823, '1'], [1665317458.254, '1'],
                       [1665318058.122, '1'], [1665318657.881, '1'], [1665319258.797, '1'], [1665319898.156, '1'],
                       [1665320467.399, '1'], [1665321085.955, '1'], [1665321697.323, '1'], [1665322272.363, '1'],
                       [1665322954.092, '1'], [1665323517.272, '1'], [1665324163.454, '1'], [1665324802.713, '1'],
                       [1665325258.408, '1'], [1665325858.526, '1'], [1665326458.785, '1'], [1665327057.759, '1'],
                       [1665327658.806, '1'], [1665328257.709, '1'], [1665328858.404, '1'], [1665329487.757, '1'],
                       [1665330130.095, '1'], [1665330658.614, '1'], [1665331307.279, '1'], [1665331951.961, '1'],
                       [1665332519.813, '1'], [1665333083.277, '1'], [1665333773.41, '1'], [1665334329.045, '1'],
                       [1665334858.393, '1'], [1665335458.288, '1'], [1665336058.207, '1'], [1665336657.961, '1'],
                       [1665337258.109, '1'], [1665337857.723, '1'], [1665338459.466, '1'], [1665339059.332, '1'],
                       [1665339694.223, '1'], [1665340322.709, '1'], [1665340863.308, '1'], [1665341475.729, '1'],
                       [1665342086.212, '1'], [1665342766.801, '1'], [1665343312.806, '1'], [1665343958.565, '1'],
                       [1665344596.184, '1'], [1665345057.908, '1'], [1665345658.745, '1'], [1665346257.692, '1'],
                       [1665346858.404, '1'], [1665347458.664, '1'], [1665348058.423, '1'], [1665348657.919, '1']]}]}}
        slo_object1 = Slo(test_json1, "0")
        slo_object2 = Slo(test_json2, "0")
        sla_object = Sla(slo_object1, slo_object2)
        sla = sla_object.get_sla()
        assert sla == 98.0


class TestPeriodicSla(unittest.TestCase):

    def test_sla1(self):
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "quarter")
        sla_object.values = [[1664659805.189, '100'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        sla = sla_object.get_sla()
        assert sla == 100.0

    def test_sla2(self):
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "quarter")
        sla_object.values = [[1664659805.189, '87'], [1664670805.189, '87'], [1664680805.189, '87'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        downtime_percentage = sla_object.get_downtime_percentage()
        sla = sla_object.get_sla()
        assert downtime_percentage == 1.0
        assert sla == 100.0

    def test_sla3(self):
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "month")
        sla_object.values = [[1664659805.189, '87'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        downtime_percentage = sla_object.get_downtime_percentage()
        sla = sla_object.get_sla()
        assert downtime_percentage == 1.0
        assert sla == 100.0

    def test_sla4(self):
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "quarter")
        sla_object.values = [[1664659805.189, '86'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        downtime_percentage = sla_object.get_downtime_percentage()
        sla = sla_object.get_sla()
        assert downtime_percentage == 1.08
        assert sla == 98.92

    def test(self):
        try:
            print("Рассчитываем месячный SLA")
            month_sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "month")
            print(f"Полученный JSON Из Виктории для : {month_sla_object.json}")
            month_sla = month_sla_object.get_sla()
            print(f"SLA Отказоустойчивость OMi GW за текущий месяц: {month_sla}%. "
                  f"Процент простоя за текущий месяц: {month_sla_object.get_downtime_percentage()}")
            cmd = "curl -d \"%s{calculation=\\\"%s\\\"} %.2f\" " \
                  "-X POST \"http://.../insert/3/prometheus/api/v1/import/prometheus\"" \
                  % ("SLA_OMI_performance", "month", month_sla)
            print(cmd)
        except Exception as e:
            print(e)

        try:
            print("\nРассчитываем квартальный SLA")
            quarter_sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "quarter")
            print(f"Полученный JSON Из Виктории для : {quarter_sla_object.json}")
            quarter_sla = quarter_sla_object.get_sla()
            print(f"SLA Отказоустойчивость OMi GW за текущий квартал: {quarter_sla}%. "
                  f"Процент простоя за текущий квартал: {quarter_sla_object.get_downtime_percentage()}")
            cmd = "curl -d \"%s{calculation=\\\"%s\\\"} %.2f\" " \
                  "-X POST \"http://.../insert/3/prometheus/api/v1/import/prometheus\"" \
                  % ("SLA_OMI_performance", "quarter", quarter_sla)
            print(cmd)
        except Exception as e:
            print(e)

    def test_calculate_period(self):
        logs_path = Path("logs")
        log = get_logger("test", logs_path)
        log.info("\n========START========")
        calculate_period_sla("SLA Работоспособность OMI", "SLA_OMI_performance", "month", log, True)
        log.info("===================")
        calculate_period_sla("SLA Работоспособность OMI", "SLA_OMI_performance", "quarter", log, True)
        log.info("===================")
        calculate_period_sla("SLA Отказоустойчивость OMi GW", "SLA_Fault_tolerance_OMi_GW", "month", log, True)
        log.info("===================")
        calculate_period_sla("SLA Отказоустойчивость OMi GW", "SLA_Fault_tolerance_OMi_GW", "quarter", log, True)
        log.info("========END========\n")

    def test_calculate_period_slo(self):
        logs_path = Path("logs")
        log = get_logger("test", logs_path)
        log.info("\n========START========")
        calculate_period_sla("SLO Доступности консоли (через балансировочный URL)",
                             "SLO_Availability_Omi_test_0600balance", "month", log, True)
        log.info("===================")
        calculate_period_sla("SLO Доступности консоли (через балансировочный URL)",
                             "SLO_Availability_Omi_test_0600balance", "quarter", log, True)
        log.info("===================")
        calculate_period_sla("SLO Работоспособность обработки событий", "SLO_Event_monitoring_OMI_DB",
                             "month", log, True)
        log.info("===================")
        calculate_period_sla("SLO Работоспособность обработки событий", "SLO_Event_monitoring_OMI_DB",
                             "quarter", log, True)
        log.info("===================")
        log.info("===================")
        calculate_period_sla("SLO Доступность GW1",
                             "SLO_Omi_test_GW1", "month", log, True)
        log.info("===================")
        calculate_period_sla("SLO Доступность GW1",
                             "SLO_Omi_test_GW1", "quarter", log, True)
        log.info("===================")
        calculate_period_sla("SLO Доступность GW2", "SLO_Omi_test_GW2",
                             "month", log, True)
        log.info("===================")
        calculate_period_sla("SLO Доступность GW2", "SLO_Omi_test_GW2",
                             "quarter", log, True)
        log.info("========END========\n")

    def test_downtime(self):
        PeriodicSla.date_now = datetime.datetime(2022, 10, 14)
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "quarter")
        sla_object.values = [[1664659805.189, '86'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        downtime_percentage = sla_object.get_downtime_percentage()
        sla = sla_object.get_sla()
        # downtime = sla_object.get_downtime()
        # allowable_downtime = sla_object.get_allowable_downtime()
        remaining_allowable_downtime = sla_object.get_remaining_allowable_downtime()
        assert remaining_allowable_downtime == 1123.2
        assert downtime_percentage == 1.08
        assert sla == 98.92

    def test_downtime2(self):
        PeriodicSla.date_now = datetime.datetime(2022, 10, 14)
        sla_object = PeriodicSla("SLA_OMI_performance{calculation=\"past_days\"}", "month")
        sla_object.values = [[1664659805.189, '87'],
                             [1664746204.522, '100'], [1664832605.724, '100'], [1664919005.918, '100'],
                             [1665005404.591, '100'], [1665091804.309, '100'], [1665178204.686, '100'],
                             [1665264605.1, '100'], [1665351007.926, '100'], [1665437404.439, '100'],
                             [1665523804.774, '100'], [1665610204.454, '100'], [1665696603.934, '100']]
        downtime_percentage = sla_object.get_downtime_percentage()
        sla = sla_object.get_sla()
        downtime = sla_object.get_downtime()
        allowable_downtime = sla_object.get_allowable_downtime()
        remaining_allowable_downtime = sla_object.get_remaining_allowable_downtime()
        remaining_allowable_downtime_percentage = sla_object.get_remaining_allowable_downtime_percentage()
        # print(downtime, allowable_downtime, remaining_allowable_downtime, remaining_allowable_downtime_percentage)
        assert remaining_allowable_downtime == 259.2
        assert remaining_allowable_downtime_percentage == 58.06
        assert downtime_percentage == 1
        assert sla == 100


if __name__ == "__main__":
    unittest.main()
